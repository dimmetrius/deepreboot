{"version":3,"sources":["rp/lib/download.js","rp/lib/pivot-table.jsx","rp/lib/dimensions.jsx","rp/lib/column-control.jsx","App.js","serviceWorker.js","index.js","rp/lib/partial.js","rp/lib/get-value.js","rp/index.jsx"],"names":["module","exports","content","filename","mime","blob","Blob","type","a","document","createElement","download","href","window","URL","createObjectURL","dataset","downloadurl","join","e","createEvent","initMouseEvent","dispatchEvent","_","range","require","React","createReactClass","partial","getValue","getDefaultProps","columns","rows","sortBy","sortDir","onSort","onSolo","onColumnHide","soloText","getInitialState","paginatePage","render","results","this","props","paginatedResults","paginate","tBody","renderTableBody","tHead","renderTableHead","className","tableClassName","renderPagination","self","map","col","title","hide","onClick","style","cursor","key","row","_key","_level","i","renderCell","text","val","dimensionExists","template","solo","value","pagination","nPaginatePages","nPages","curPage","n","c","setPaginatePage","length","state","nPaginateRows","isFinite","Math","ceil","iBoundaryRow","boundaryLevel","parentRows","unshift","iEnd","concat","slice","nPage","setState","compact","dimensions","selectedDimensions","onChange","subDimensionText","nSelected","renderDimension","toggleDimension","dimension","selectedDimension","iDimension","evt","target","curIdx","indexOf","updatedDimensions","without","hiddenColumns","showColumn","column","hidden","usersData","Emitter","TextWithToolTip","tooltip","daysOfWeek","getToolTipText","P","F","C","K","FBR","SGR","getDateFromStr","dStr","split","dd","mm","yyyy","Date","ISO8601_week_no","dt","tdt","valueOf","dayn","getDay","setDate","getDate","firstThursday","setMonth","getTime","day","dayOfWeek","d","getWeekFromDStr","date","emitter","round","num","p","exp","pow","parse","parseFloat","replace","reduce","memo","M","Pg","Fg","Cg","FBRg","SGRg","Kcal","count","kcal","m","f","fbr","sgr","calcP","calcF","calcC","calcAll","percP","percF","percC","calculations","App","obj","location","search","sum","el","par","curDate","curYear","getFullYear","curWeek","week","year","user","pivotParams","filter","item","w","getWeekFromDate","y","eventBus","activeDimensions","Boolean","hostname","match","ReactDOM","StrictMode","getElementById","navigator","serviceWorker","ready","then","registration","unregister","catch","error","console","message","Array","prototype","fn","partialArgs","call","arguments","apply","find","DataFrame","PivotTable","Dimensions","ColumnControl","displayName","csvDownloadFileName","csvTemplateFormat","defaultStyles","hideRows","excludeSummaryFromExport","onData","allDimensions","componentWillMount","dataFrame","updateRows","componentWillReceiveProps","newProps","setHiddenColumns","getColumns","forEach","push","hideDimensionFilter","setDimensions","Object","keys","clear","clearSolo","setSort","hideColumn","setSolo","sortByTitle","sortCol","calcOpts","dVals","pass","calculate","emit","setTimeout","cTitle","newSolo","oldSolo","k","downloadCSV","csv","JSON","stringify","bind","maxLevel","excludeSummary","vals"],"mappings":"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","file":"static/js/main.c59f9a20.chunk.js","sourcesContent":["module.exports = function(content, filename, mime) {\n  if (mime == null) mime = 'text/csv'\n\n  var blob = new Blob([content], { type: mime })\n\n  var a = document.createElement('a')\n  a.download = filename\n  a.href = window.URL.createObjectURL(blob)\n  a.dataset.downloadurl = [mime, a.download, a.href].join(':')\n\n  var e = document.createEvent('MouseEvents')\n  e.initMouseEvent('click', true, false, window, 0, 0, 0, 0, 0, false, false,\n    false, false, 0, null)\n  return a.dispatchEvent(e)\n}\n","var _ = { range: require('lodash/range') }\nvar React = require('react')\nvar createReactClass = require('create-react-class')\nvar partial = require('./partial')\nvar getValue = require('./get-value')\n\nmodule.exports = createReactClass({\n\n  getDefaultProps: function () {\n    return {\n      columns: [],\n      rows: [],\n      sortBy: null,\n      sortDir: 'asc',\n      onSort: function () {},\n      onSolo: function () {},\n      onColumnHide: function () {},\n      soloText: \"solo\"\n    }\n  },\n\n  getInitialState: function () {\n    return {\n      paginatePage: 0\n    }\n  },\n\n  render: function() {\n    var results = this.props.rows\n\n    var paginatedResults = this.paginate(results)\n\n    var tBody = this.renderTableBody(this.props.columns, paginatedResults.rows)\n    var tHead = this.renderTableHead(this.props.columns)\n\n    return (\n      <div className='reactPivot-results'>\n        <table className={this.props.tableClassName}>\n          {tHead}\n          {tBody}\n        </table>\n\n        {this.renderPagination(paginatedResults)}\n      </div>\n    )\n  },\n\n  renderTableHead: function(columns) {\n    var self = this\n    var sortBy = this.props.sortBy\n    var sortDir =  this.props.sortDir\n\n    return (\n      <thead>\n        <tr>\n          { columns.map(function(col) {\n            var className = col.className\n            if (col.title === sortBy) className += ' ' + sortDir\n\n            var hide = ''\n            if (col.type !== 'dimension') hide = (\n              <span className='reactPivot-hideColumn'\n                    onClick={partial(self.props.onColumnHide, col.title)}>\n                &times;\n              </span>\n            )\n\n            return (\n              <th className={className}\n                  onClick={partial(self.props.onSort, col.title)}\n                  style={{cursor: 'pointer'}}\n                  key={col.title}>\n\n                {hide}\n                {col.title}\n              </th>\n            )\n          })}\n        </tr>\n      </thead>\n    )\n  },\n\n  renderTableBody: function(columns, rows) {\n    var self = this\n\n    return (\n      <tbody>\n        {rows.map(function(row) {\n          return (\n            <tr key={row._key} className={\"reactPivot-level-\" + row._level}>\n              {columns.map(function(col, i) {\n                if (i < row._level) return <td key={i} className='reactPivot-indent' />\n\n                return self.renderCell(col, row)\n              })}\n            </tr>\n          )\n\n        })}\n      </tbody>\n    )\n  },\n\n  renderCell: function(col, row) {\n    if (col.type === 'dimension') {\n      var val = row[col.title]\n      var text = val\n      var dimensionExists = (typeof val) !== 'undefined'\n      if (col.template && dimensionExists) text = col.template(val, row)\n    } else {\n      var val = getValue(col, row)\n      var text = val\n      if (col.template) text = col.template(val, row)\n    }\n\n    if (dimensionExists) {\n      var solo = (\n        <span className='reactPivot-solo'>\n          <a style={{cursor: 'pointer'}}\n             onClick={partial(this.props.onSolo, {\n                title: col.title,\n                value: val\n              })}>{this.props.soloText}</a>\n        </span>\n      )\n    }\n\n    return(\n      <td className={col.className}\n          key={[col.title, row.key].join('\\xff')}\n          title={col.title}>\n        <span>{text || (text === 0 && '0') || ''}</span> {solo}\n      </td>\n    )\n  },\n\n  renderPagination: function(pagination) {\n    var self = this\n    var nPaginatePages = pagination.nPages\n    var paginatePage = pagination.curPage\n\n    if (nPaginatePages === 1) return ''\n\n    return (\n      <div className='reactPivot-paginate'>\n        {_.range(0, nPaginatePages).map(function(n) {\n          var c = 'reactPivot-pageNumber'\n          if (n === paginatePage) c += ' is-selected'\n          return (\n            <span className={c} key={n}>\n              <a onClick={partial(self.setPaginatePage, n)}>{n+1}</a>\n            </span>\n          )\n        })}\n      </div>\n    )\n  },\n\n  paginate: function(results) {\n    if (results.length <= 0) return {rows: results, nPages: 1, curPage: 0}\n\n    var paginatePage = this.state.paginatePage\n    var nPaginateRows = this.props.nPaginateRows\n    if (!nPaginateRows || !isFinite(nPaginateRows)) nPaginateRows = results.length\n\n    var nPaginatePages = Math.ceil(results.length / nPaginateRows)\n    if (paginatePage >= nPaginatePages) paginatePage = nPaginatePages - 1\n\n    var iBoundaryRow = paginatePage * nPaginateRows\n\n    var boundaryLevel = results[iBoundaryRow]._level\n    var parentRows = []\n    if (boundaryLevel > 0) {\n      for (var i = iBoundaryRow-1; i >= 0; i--) {\n        if (results[i]._level < boundaryLevel) {\n          parentRows.unshift(results[i])\n          boundaryLevel = results[i]._level\n        }\n        if (results[i]._level === 9) break\n      }\n    }\n\n    var iEnd = iBoundaryRow + nPaginateRows\n    var rows = parentRows.concat(results.slice(iBoundaryRow, iEnd))\n\n    return {rows: rows, nPages: nPaginatePages, curPage: paginatePage}\n  },\n\n  setPaginatePage: function(nPage) {\n    this.setState({paginatePage: nPage})\n  }\n})\n\n","var _ = { compact: require('lodash/compact') }\nvar React = require('react')\nvar createReactClass = require('create-react-class')\nvar partial = require('./partial')\n\nmodule.exports = createReactClass({\n  getDefaultProps: function () {\n    return {\n      dimensions: [],\n      selectedDimensions: [],\n      onChange: function () { },\n      subDimensionText: \"Sub Dimension...\"\n    }\n  },\n\n  render: function () {\n    var self = this\n    var subDimensionText = this.props.subDimensionText\n    var selectedDimensions = this.props.selectedDimensions\n    var nSelected = selectedDimensions.length\n\n    return (\n      <div className=\"reactPivot-dimensions\">\n        {selectedDimensions.map(this.renderDimension)}\n\n        <select value={''} onChange={partial(self.toggleDimension, nSelected)}>\n          <option value={''}>{subDimensionText}</option>\n          {self.props.dimensions.map(function (dimension) {\n            return <option key={dimension.title}>{dimension.title}</option>\n          })}\n        </select>\n      </div>\n    )\n  },\n\n  renderDimension: function(selectedDimension, i) {\n    return (\n      <select\n        value={selectedDimension}\n        onChange={partial(this.toggleDimension, i)}\n        key={selectedDimension} >\n        <option></option>\n        {this.props.dimensions.map(function(dimension) {\n          return (\n            <option\n              value={dimension.title}\n              key={dimension.title} >\n              {dimension.title}\n            </option>\n          )\n        })}\n      </select>\n    )\n  },\n\n  toggleDimension: function (iDimension, evt) {\n    var dimension = evt.target.value\n    var dimensions = this.props.selectedDimensions\n\n    var curIdx = dimensions.indexOf(dimension)\n    if (curIdx >= 0) dimensions[curIdx] = null\n    dimensions[iDimension] = dimension\n\n    var updatedDimensions = _.compact(dimensions)\n\n    this.props.onChange(updatedDimensions)\n  },\n})\n","var _ = { without: require('lodash/without') }\nvar React = require('react')\nvar createReactClass = require('create-react-class')\n\nmodule.exports = createReactClass({\n  getDefaultProps: function () {\n    return {\n      hiddenColumns: [],\n      onChange: function () {}\n    }\n  },\n\n  render: function () {\n    return (\n      <div className='reactPivot-columnControl'>\n        { !this.props.hiddenColumns.length ? '' :\n          <select value={''} onChange={this.showColumn}>\n            <option value={''}>Hidden Columns</option>\n            { this.props.hiddenColumns.map(function(column) {\n              return <option key={column}>{column}</option>\n            })}\n          </select>\n        }\n      </div>\n    )\n  },\n\n  showColumn: function (evt) {\n    var col = evt.target.value\n    var hidden = _.without(this.props.hiddenColumns, col)\n    this.props.onChange(hidden)\n  },\n})\n","import React from 'react';\nimport './App.css';\nimport ReactPivot from './rp/index';\nimport data from './food.csv.json';\n\nconst usersData = {\n  'dimmetrius': data,\n}\n\nvar Emitter = require('wildemitter')\n\n\nconst TextWithToolTip = ({text, tooltip}) => (\n  <div className=\"tooltip\">\n    {text}\n    <span className=\"tooltiptext\">{tooltip}</span>\n  </div>\n)\nconst daysOfWeek = ['Вс','Пн','Вт','Ср','Чт','Пт','Сб'];\nconst getToolTipText = (row) => {\n  const {P, F, C, K, FBR, SGR} = row;\n  return [`Б: ${P}`, `Ж: ${F}`, `У: ${C}`, `клтч.: ${FBR}`,`схр.: ${SGR}`,`Ккал ${K}`].join(';\\n');\n}\n\n\nconst getDateFromStr = (dStr) => {\n  const [dd, mm, yyyy] = dStr.split('.')\n  const d = new Date(yyyy, mm - 1, dd);\n  return d;\n}\n\nconst getWeekFromDate = (d) => {\n  return ISO8601_week_no(d);\n}\n\nconst getWeekFromDStr = (dStr) => {\n  const d = getDateFromStr(dStr);\n  return ISO8601_week_no(d);\n}\n\nconst ISO8601_week_no = (dt) => {\n  var tdt = new Date(dt.valueOf());\n  var dayn = (dt.getDay() + 6) % 7;\n  tdt.setDate(tdt.getDate() - dayn + 3);\n  var firstThursday = tdt.valueOf();\n  tdt.setMonth(0, 1);\n  if (tdt.getDay() !== 4) {\n    tdt.setMonth(0, 1 + ((4 - tdt.getDay()) + 7) % 7);\n  }\n  return 1 + Math.ceil((firstThursday - tdt) / 604800000);\n}\n\nvar dimensions = [\n  {\n    value: (row) => {\n      return getDateFromStr(row['date']);      \n    },\n    sortBy: (row) => { return getDateFromStr(row['date']).getTime() }, \n    title: 'Дата',\n    template: (val, row) => {\n      const dStr = row['date'];\n      const d = new Date(val);\n      const day = d.getDay();\n      const dayOfWeek = daysOfWeek[day];\n      return `${dStr}, ${dayOfWeek}`;\n    }\n  },\n  {value: 'meal', title: 'Прием'},\n  {\n    value: 'product', \n    title: 'Продукт', \n    template: (val, row) => <TextWithToolTip text={`${row['Продукт']}`} tooltip={getToolTipText(row)}/>\n  },\n  {\n    title: 'Неделя',\n    value: (row) => getWeekFromDStr(row.date) ,\n    className: 'alignRight',\n  },\n]\n\nconst emitter = new Emitter();\n\n/*\nconst activeDimensions = ['Дата', 'Продукт'];\n\nlet dimsCount = activeDimensions.length;\n\nemitter.on('activeDimensions', function (dims) {\n  dimsCount = dims.length;\n});\n*/\n\nconst round = (num, p = 0) => {\n  const exp = Math.pow(10, p);\n  return Math.round(num*exp)/exp;\n};\nconst parse = (val = '0') => parseFloat(val.replace(',','.'));\nconst reduce = function(row, memo) {\n  const {M, Pg, Fg, Cg, FBRg, SGRg, Kcal} = row;\n  memo.count = 1;\n  memo.kcal = (memo.kcal || 0) + parse(Kcal);\n  memo.m = (memo.m || 0) + parse(M);\n  memo.p = (memo.p || 0) + parse(Pg);\n  memo.f = (memo.f || 0) + parse(Fg);\n  memo.c = (memo.c || 0) + parse(Cg);\n\n  memo.fbr = (memo.fbr || 0) + parse(FBRg);\n  memo.sgr = (memo.sgr || 0) + parse(SGRg);\n\n  memo.calcP = /*(memo.calcP || 0) */  memo.p * 4;\n  memo.calcF = /*(memo.calcF || 0) */  memo.f * 9;\n  memo.calcC = /*(memo.calcC || 0) */  memo.c * 4;\n  memo.calcAll = /*(memo.calcAll || 0) */ memo.calcP + memo.calcF + memo.calcC;\n  memo.percP = /*(memo.percP || 0) */ memo.calcP/memo.calcAll*100;\n  memo.percF = /*(memo.percF || 0) */ memo.calcF/memo.calcAll*100;\n  memo.percC = /*(memo.percC || 0) */ memo.calcC/memo.calcAll*100;\n  return {...memo, ...row}\n}\n\nconst calculations = [\n  {\n    title: 'М г',\n    value: (row) => `${round(row.m)} г.`,\n    className: 'alignRight',\n    sortBy: (row) => row.m,\n  },\n\n  {\n    title: 'Б г, %',\n    value: (row) => row.p,\n    className: 'alignRight',\n    template: (val, row) => `${round(row.p)} г, ${round(row.percP)}%`,\n    sortBy: (row) => row.p,\n  },\n\n  {\n    title: 'Ж г, %',\n    value: (row) => row.f,\n    className: 'alignRight',\n    template: (val, row) => `${round(row.f)} г, ${round(row.percF)}%`,\n    sortBy: (row) => row.f,\n  },\n\n  {\n    title: 'У г, %',\n    value: (row) => row.c,\n    template: (val, row) => `${round(row.c)} г, ${round(row.percC)}%`,\n    className: 'alignRight',\n    sortBy: (row) => row.c,\n  },\n\n  {\n    title: 'Клтч. г',\n    value: (row) => row.fbr,\n    template: (val, row) => `${round(row.fbr, 1)} г`,\n    className: 'alignRight',\n    sortBy: (row) => row.fbr,\n  },\n\n  {\n    title: 'Схр. г',\n    value: (row) => row.sgr,\n    template: (val, row) => `${round(row.sgr, 1)} г`,\n    className: 'alignRight',\n    sortBy: (row) => row.sgr,\n  },\n\n  {\n    title: 'Ккал',\n    value: (row) => row.kcal,\n    template: (val, row) => `${round(row.kcal)}`,\n    className: 'alignRight',\n    sortBy: (row) => row.kcal,\n  },\n  \n  /*\n  {\n    title: 'Amount',\n    value: 'amountTotal',\n    template: function(val, row) {\n      return '$' + val.toFixed(2)\n    },\n    className: 'alignRight'\n  },\n  {\n    title: 'Avg Amount',\n    value: function(row) {\n      return row.amountTotal / row.count\n    },\n    template: function(val, row) {\n      return '$' + val.toFixed(2)\n    },\n    className: 'alignRight'\n  }\n  */\n]\nfunction App() {\n  const search = (window.location.search || '').replace('?','');\n  const pairs = search.split('&');\n  const obj = pairs.reduce((sum, el) => {\n    const [par, val] = el.split('=');\n    sum[par] = val;\n    return {...sum};\n  }, {});\n  \n  const curDate = new Date();\n  const curYear = curDate.getFullYear();\n  const curWeek = ISO8601_week_no(curDate);\n  const week = parseFloat(obj['w']) || curWeek;\n  const year = parseFloat(obj['y']) || curYear;\n  const user = obj['u'] || '-';\n\n  const inp = (usersData[user] || []).filter(item => {\n    const d = getDateFromStr(item.date);\n    const w = getWeekFromDate(d);\n    const y = d.getFullYear();\n    return w === week && y === year;\n  });\n\n  const activeDimensions = ['Дата', 'Прием', 'Продукт'];\n  const pivotParams = {\n    rows: inp,\n    eventBus: emitter,\n    dimensions: dimensions, \n    calculations: calculations,\n    reduce: reduce,\n    activeDimensions: activeDimensions,\n    nPaginateRows: 300\n  }\n\n  return (\n    <div className=\"App\">\n    <h3>{`Дневник питания на ${week} неделе ${year}-го года`}</h3>\n    <ReactPivot {...pivotParams} />\n    </div>\n  );\n}\n\nexport default App;\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.0/8 are considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport function register(config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl, {\n    headers: { 'Service-Worker': 'script' },\n  })\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready\n      .then(registration => {\n        registration.unregister();\n      })\n      .catch(error => {\n        console.error(error.message);\n      });\n  }\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport * as serviceWorker from './serviceWorker';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister();\n","var slice = Array.prototype.slice\n\nmodule.exports = function (fn) {\n  var partialArgs = slice.call(arguments, 1)\n  return function() {\n    return fn.apply(this, partialArgs.concat(slice.call(arguments)))\n  }\n}\n","module.exports = function getValue (dimension, row) {\n  if (dimension == null) return null\n  var val\n  if (typeof dimension.value === 'string') {\n    val = row[dimension.value]\n  } else {\n    val = dimension.value(row)\n  }\n  return val\n}\n","var _ = {\n  filter: require('lodash/filter'),\n  map: require('lodash/map'),\n  find: require('lodash/find')\n}\nvar React = require('react')\nvar createReactClass = require('create-react-class')\nvar DataFrame = require('dataframe')\nvar Emitter = require('wildemitter')\n\nvar partial = require('./lib/partial')\nvar download = require('./lib/download')\nvar getValue = require('./lib/get-value')\nvar PivotTable = require('./lib/pivot-table.jsx')\nvar Dimensions = require('./lib/dimensions.jsx')\nvar ColumnControl = require('./lib/column-control.jsx')\n\nmodule.exports = createReactClass({\n  displayName: 'ReactPivot',\n  getDefaultProps: function() {\n    return {\n      rows: [],\n      dimensions: [],\n      activeDimensions: [],\n      reduce: function() {},\n      tableClassName: '',\n      csvDownloadFileName: 'table.csv',\n      csvTemplateFormat: false,\n      defaultStyles: true,\n      nPaginateRows: 25,\n      solo: {},\n      hiddenColumns: [],\n      hideRows: null,\n      sortBy: null,\n      sortDir: 'asc',\n      eventBus: new Emitter,\n      compact: false,\n      excludeSummaryFromExport: false,\n      onData: function () {},\n      soloText: \"solo\",\n      subDimensionText: \"Sub Dimension...\"\n    }\n  },\n\n  getInitialState: function() {\n    var allDimensions = this.props.dimensions\n    var activeDimensions =  _.filter(this.props.activeDimensions, function (title) {\n      return _.find(allDimensions, function(col) {\n        return col.title === title\n      })\n    })\n\n    return {\n      dimensions: activeDimensions,\n      calculations: {},\n      sortBy: this.props.sortBy,\n      sortDir: this.props.sortDir,\n      hiddenColumns: this.props.hiddenColumns,\n      solo: this.props.solo,\n      hideRows: this.props.hideRows,\n      rows: []\n    }\n  },\n\n  componentWillMount: function() {\n    if (this.props.defaultStyles) loadStyles()\n\n    this.dataFrame = DataFrame({\n      rows: this.props.rows,\n      dimensions: this.props.dimensions,\n      reduce: this.props.reduce\n    })\n\n    this.updateRows()\n  },\n\n  componentWillReceiveProps: function(newProps) {\n     if(newProps.hiddenColumns !== this.props.hiddenColumns) {\n         this.setHiddenColumns(newProps.hiddenColumns);\n     }\n\n    if(newProps.rows !== this.props.rows) {\n      this.dataFrame = DataFrame({\n        rows: newProps.rows,\n        dimensions: newProps.dimensions,\n        reduce: newProps.reduce\n      })\n\n      this.updateRows()\n    }\n  },\n\n  getColumns: function() {\n    var self = this\n    var columns = []\n\n    this.state.dimensions.forEach(function(title) {\n      var d =  _.find(self.props.dimensions, function(col) {\n        return col.title === title\n      })\n\n      columns.push({\n        type: 'dimension', title: d.title, value: d.value,\n        className: d.className, template: d.template, sortBy: d.sortBy\n      })\n    })\n\n    this.props.calculations.forEach(function(c) {\n      if (self.state.hiddenColumns.indexOf(c.title) >= 0) return\n\n      columns.push({\n        type:'calculation', title: c.title, template: c.template,\n        value: c.value, className: c.className, sortBy: c.sortBy\n      })\n    })\n\n    return columns\n  },\n\n  render: function() {\n    const showExport = false;\n\n    var self = this\n\n    var html = (\n      <div className='reactPivot'>\n\n      { this.props.hideDimensionFilter ? '' :\n        <Dimensions\n          dimensions={this.props.dimensions}\n          subDimensionText={this.props.subDimensionText}\n          selectedDimensions={this.state.dimensions}\n          onChange={this.setDimensions} />\n      }\n\n        <ColumnControl\n          hiddenColumns={this.state.hiddenColumns}\n          onChange={this.setHiddenColumns} />\n\n        {showExport ? \n        <div className=\"reactPivot-csvExport\">\n          <button onClick={partial(this.downloadCSV, this.state.rows)}>\n            Export CSV\n          </button>\n        </div> : null}\n\n        { Object.keys(this.state.solo).map(function (title) {\n          var value = self.state.solo[title]\n\n          return (\n            <div\n              style={{clear: 'both'}}\n              className='reactPivot-soloDisplay'\n              key={'solo-' + title} >\n              <span\n                className='reactPivot-clearSolo'\n                onClick={partial(self.clearSolo, title)} >\n                &times;\n              </span>\n              {title}: {value}\n            </div>\n          )\n        }) }\n\n        <PivotTable\n          columns={this.getColumns()}\n          rows={this.state.rows}\n          sortBy={this.state.sortBy}\n          sortDir={this.state.sortDir}\n          onSort={this.setSort}\n          onColumnHide={this.hideColumn}\n          nPaginateRows={this.props.nPaginateRows}\n          tableClassName={this.props.tableClassName}\n          onSolo={this.setSolo}\n          soloText={this.props.soloText}\n        />\n      </div>\n    )\n\n    return html\n  },\n\n  updateRows: function () {\n    var columns = this.getColumns()\n\n    var sortByTitle = this.state.sortBy\n    var sortCol = _.find(columns, function(col) {\n      return col.title === sortByTitle\n    }) || {}\n    var sortBy = sortCol.sortBy || (sortCol.type === 'dimension' ? sortCol.title : sortCol.value);\n    var sortDir = this.state.sortDir\n    var hideRows = this.state.hideRows\n\n    var calcOpts = {\n      dimensions: this.state.dimensions,\n      sortBy: sortBy,\n      sortDir: sortDir,\n      compact: this.props.compact\n    }\n\n    var filter = this.state.solo\n    if (filter) {\n      calcOpts.filter = function(dVals) {\n        var pass = true\n        Object.keys(filter).forEach(function (title) {\n          if (dVals[title] !== filter[title]) pass = false\n        })\n        return pass\n      }\n    }\n\n    var rows = this.dataFrame\n      .calculate(calcOpts)\n      .filter(function (row) { return hideRows ? !hideRows(row) : true })\n    this.setState({rows: rows})\n    this.props.onData(rows)\n  },\n\n  setDimensions: function (updatedDimensions) {\n    this.props.eventBus.emit('activeDimensions', updatedDimensions)\n    this.setState({dimensions: updatedDimensions})\n    setTimeout(this.updateRows, 0)\n  },\n\n  setHiddenColumns: function (hidden) {\n    this.props.eventBus.emit('hiddenColumns', hidden)\n    this.setState({hiddenColumns: hidden})\n    setTimeout(this.updateRows, 0)\n  },\n\n  setSort: function(cTitle) {\n    var sortBy = this.state.sortBy\n    var sortDir = this.state.sortDir\n    if (sortBy === cTitle) {\n      sortDir = (sortDir === 'asc') ? 'desc' : 'asc'\n    } else {\n      sortBy = cTitle\n      sortDir = 'asc'\n    }\n\n    this.props.eventBus.emit('sortBy', sortBy)\n    this.props.eventBus.emit('sortDir', sortDir)\n    this.setState({sortBy: sortBy, sortDir: sortDir})\n    setTimeout(this.updateRows, 0)\n  },\n\n  setSolo: function(solo) {\n    var newSolo = this.state.solo\n    newSolo[solo.title] = solo.value\n    this.props.eventBus.emit('solo', newSolo)\n    this.setState({solo: newSolo })\n    setTimeout(this.updateRows, 0)\n  },\n\n  clearSolo: function(title) {\n    var oldSolo = this.state.solo\n    var newSolo = {}\n    Object.keys(oldSolo).forEach(function (k) {\n      if (k !== title) newSolo[k] = oldSolo[k]\n    })\n    this.props.eventBus.emit('solo', newSolo)\n    this.setState({solo: newSolo})\n    setTimeout(this.updateRows, 0)\n  },\n\n  hideColumn: function(cTitle) {\n    var hidden = this.state.hiddenColumns.concat([cTitle])\n    this.setHiddenColumns(hidden)\n    setTimeout(this.updateRows, 0)\n  },\n\n  downloadCSV: function(rows) {\n    var self = this\n\n    var columns = this.getColumns()\n\n    var csv = _.map(columns, 'title')\n      .map(JSON.stringify.bind(JSON))\n      .join(',') + '\\n'\n\n    var maxLevel = this.state.dimensions.length - 1\n    var excludeSummary = this.props.excludeSummaryFromExport\n\n    rows.forEach(function(row) {\n      if (excludeSummary && (row._level < maxLevel)) return\n\n      var vals = columns.map(function(col) {\n\n        if (col.type === 'dimension') {\n          var val = row[col.title]\n        } else {\n          var val = getValue(col, row)\n        }\n\n        if (col.template && self.props.csvTemplateFormat) {\n          val = col.template(val)\n        }\n\n        return JSON.stringify(val)\n      })\n      csv += vals.join(',') + '\\n'\n    })\n\n    download(csv, this.props.csvDownloadFileName, 'text/csv')\n  }\n})\n\nfunction loadStyles () { require('./style.css') }\n"],"sourceRoot":""}